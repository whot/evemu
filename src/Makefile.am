version_script = $(srcdir)/libevemu.ver

lib_LTLIBRARIES = libevemu.la

libevemu_la_LDFLAGS = \
	-version-info @LIB_VERSION@ \
	-Wl,-z,defs -Wl,--as-needed \
	-Wl,--version-script=$(version_script)

libevemu_la_SOURCES = \
	evemu-impl.h \
	evemu.c \
	version.h

libevemu_la_LIBADD = $(LIBEVDEV_LIBS)

AM_CPPFLAGS = -I$(top_srcdir)/include/ $(LIBEVDEV_CFLAGS)

libevemuincludedir = $(includedir)
libevemuinclude_HEADERS = evemu.h

libevemu.ver: evemu.c-libver.xslt evemu.xml
	$(XSLTPROC) $(srcdir)/evemu.c-libver.xslt evemu.xml > $@

evemu.h: evemu.c-header.xslt evemu.xml
	$(XSLTPROC) $(srcdir)/evemu.c-header.xslt evemu.xml > $@

event_names.py: Makefile make-event-names.py
	$(PYTHON) $(srcdir)/make-event-names.py --output=python > $@

EXTRA_DIST = $(version_script) \
	     make-event-names.py \
	     convert-old-dumps-to-1.1.py  \
	     evemu.c-header.xslt \
	     evemu.c-libver.xslt \
	     evemu.python-api.xslt \
	     evemu.xml
CLEANFILES = event_names.py event_names.pyc evemu.h libevemu.ver
BUILT_SOURCES = event_names.py evemu.h libevemu.ver
